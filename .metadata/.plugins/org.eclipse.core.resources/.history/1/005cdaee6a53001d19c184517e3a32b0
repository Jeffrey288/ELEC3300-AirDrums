#include "tft.h"
#include "lcd.h"
#include "tft_helpers.h"

int errorFlag = 0;
char errorMsg[30];

void error_handler(char err[30]) {
	errorFlag = 1;
	char* pt;
	for (pt = errorMsg; *err != 0; err++, pt++) {
		*pt = *err;
	} *pt = 0; // ending the string
	HAL_Delay(1000);
}

void tft_task() { // help other threads print their stuff
	LCD_INIT();
	int last_tick = 0;

	while (!errorFlag) {

		if (HAL_GetTick() - last_tick > 200) {
			HAL_GPIO_TogglePin(GPIOB, GPIO_PIN_0);
			last_tick = HAL_GetTick();
		}


	}
	while (1) {
		tft_set_textColor(RED);
		tft_prints(0, 0, errorMsg);
	}
}
